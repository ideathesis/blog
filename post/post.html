<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Template Post</title>
    <style>
        /* CSS tetap sama seperti sebelumnya */
    </style>
</head>
<body>
    <header>
        <h1 id="post-title">Memuat Judul...</h1>
        <p class="author-date">
            <strong>Penulis:</strong> <span id="post-author">Memuat Penulis...</span> |
            <strong>Tanggal:</strong> <span id="post-date">Memuat Tanggal...</span>
        </p>
    </header>
    <div class="content">
        <img id="post-image" src="" alt="Featured Image" class="featured-image">
        <div id="post-content">
            <p>Memuat konten artikel...</p>
        </div>
    </div>
    <footer>
        &copy; 2024 Blog Skripsi
    </footer>

    <!-- Tambahkan marked.js -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        async function loadArticleContent(articleFile) {
            try {
                // Mengambil konten artikel dari file Markdown
                const response = await fetch(`post/${articleFile}`);
                if (!response.ok) {
                    throw new Error('Gagal memuat artikel.');
                }
                const markdown = await response.text();

                // Parsing metadata JSON dari komentar di awal file
                const metadataMatch = markdown.match(/<!--\s*Metadata\s*-->\s*({[\s\S]*?})/);
                if (!metadataMatch) {
                    throw new Error('Metadata artikel tidak ditemukan.');
                }
                const metadata = JSON.parse(metadataMatch[1]);

                // Memperbarui elemen di halaman dengan metadata
                document.getElementById('post-title').textContent = metadata.title;
                document.getElementById('post-author').textContent = metadata.author;
                document.getElementById('post-date').textContent = metadata.date;
                document.getElementById('post-image').src = metadata.image;
                document.getElementById('post-image').alt = metadata.title;

                // Menghapus metadata dari konten Markdown
                const contentMarkdown = markdown.replace(/<!--\s*Metadata\s*-->\s*{[\s\S]*?}/, '').trim();
                
                // Mengonversi Markdown ke HTML menggunakan marked.js
                const contentHtml = marked.parse(contentMarkdown);
                document.getElementById('post-content').innerHTML = contentHtml;
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('post-content').innerHTML = '<p>Gagal memuat artikel. Silakan coba lagi nanti.</p>';
            }
        }

        // Ambil parameter query dari URL untuk menentukan file Markdown yang dimuat
        const urlParams = new URLSearchParams(window.location.search);
        const articleFile = urlParams.get('file') || 'post_0.md'; // Default ke post_0.md jika tidak ada parameter
        loadArticleContent(articleFile);
    </script>
</body>
</html>